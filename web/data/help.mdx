# HUD Modifications
![HUD Image](/smhud.png)

1. Input display shows which buttons where held on the previous frame.
2. Status display defaults to first enemy's HP, but can be configured to show Charge Timer, X-Factor timer, Shinespark timer and more (see InfoHUD Modes).
3. Current total energy (excluding reserves), sometimes overridden by status display contents.
4. Status icon display can be enabled to show when you have a shinespark stored, health bomb flag, and more.
5. Segment timer in minutes.seconds.frames. Resets when starting a new game, loading a preset, or by controller/menu shortcut.
6. Room timer in seconds.frames, resets when entering a new room and updates on item acquisition and room transitions. Can be set to realtime or gametime.
7. Lag frames, updates same as above.
8. Frames spent by last door transition.
9. Item collection percentage, which can be configured to show reserve energy instead.


# Controller Shortcuts

| **Controller 1**          | 
| :---                      | :---   |
| Start + Select + L + R    | Soft reset the game
| Start + Select            | Opens the in-game menu (configurable in shortcuts menu)
| B                         | Closes the in-game menu
| Start + Y + L             | Reloads the last used preset (configurable in shortcuts menu)
|&nbsp;|
| **Controller 2**          |
| L or R                    | Toggles the status display options mentioned in 1
| Up                        | Increases game speed
| Down                      | Decreases game speed
| Right                     | Frame advance
| Left                      | Restore game speed


# Built-In Savestate Feature

The savestate feature allows you to save and instantly reload at nearly any part of gameplay. This is achieved by transferring all of the console's working memory and video memory into the battery backed storage on the cartridge, also known as SRAM. It requires a very large amount of SRAM to store all of that data. Much more than commercial games offered (or needed), even though it was possible at the time. As a result, many platforms (including official Virtual Console releases) do not allow saving more than 64K or 128K of SRAM, while 256K is needed for full savestate support. Platforms known to support 256K include FXPAK (formerly known as SD2SNES), bsnes and Mesen-S emulators, and the Super NT when equipped with the "jailbreak" firmware.
&nbsp;  

A separate version of the practice hack is offered with a modified version of savestates. It offers the same features of normal savestates, but uses some of the game's own loading routines to reduce the amount of data that needs to be stored. This brings the SRAM requirements down to 128K. The trade-off is that the saved state takes slightly longer to restore. Most modern PC emulators will work with this version. The older Everdrive flash carts are assumed to support this version.
&nbsp;  

If you experience crashes or severe glitches when using savestates, your platform may not be supported. It's recommended that you use a version of the practice hack without the built-in savestate feature. You can still use any savestate functionality offered by your platform.


# Menu Features

| <th width="600" />            |       |
| :---                          | :---  |
| **Equipment**                 | Configure Samus' current equipment
| - Refill                      | Refills your ammo and energy to their current max
| - Category Loadouts           | Select a category to set your current equipment
| - Toggle Items                | Toggle major items
| - Toggle Beams                | Toggle beams or activate glitched beams
| - Current Energy              | Set your current energy with left/right or A to increment
| - Energy Tanks                | Select your max E-tanks with left/right or A to increment
| - Current Reserves            | Set your current reserves with left/right or A to increment
| - Reserve Tanks               | Select your max Reserve Tanks with left/right or A to increment
| - Missiles                    | Select your max Missiles with left/right or A to increment
| - Super Missiles              | Select your max Super Missiles with left/right or A to increment
| - Power Bombs                 | Select your max Power Bombs with left/right or A to increment
|&nbsp;|
| **Category Presets**          | Presets are pre-configured savestates that are specific to a particular category.
|                               | **Note**: Presets load a room but do not load any enemies for that room.
|&nbsp;|
| **Preset Options**            | Select a category or save/load custom presets
| - Select Preset Category      | Select the desired category to be used with Category Presets
| - Custom Preset Slot          | Select one of 40 slots in memory to save or load custom presets
| - Save Custom Preset          | Save a custom preset to the current slot in SRAM.
|                               | A grapple sound effect will play if a preset cannot be saved (for example during room transition).
| - Load Custom Preset          | Load the custom preset in the current slot in SRAM.
|                               | A grapple sound effect will play if a preset cannot be loaded from the current slot.
| - Open Blue Doors             | Open all blue doors, except when Samus is in default pose or when door is in a hidden area.
| - Compressed Graphics         | Use built-in and slower compressed tile graphics when loading presets.
|                               | Only enable this if you are applying patches that use banks F5-FE and loading prests crashes the game.
| - Compressed Palettes         | Use built-in compressed palettes when loading presets.
|                               | Only enable this if you are applying custom room palettes.
| - Compressed Tables           | Use built-in compressed tile tables when loading presets.
|&nbsp;|
| **Teleport**                  | Warp to any save station
|&nbsp;|
| **Events**                    | Toggle event flags for doors, bosses, items, and other events
| - Reset All Events            | Clear all event flags
| - Reset All Doors             | Reset all door locks
| - Reset All Items             | Replace all items that have already been collected
| - Bosses                      | Toggle boss kills
|&nbsp;|
| **Misc**                      | Toggle extra features
| - Blue Suit                   | Give Samus the Blue Suit
| - Flash Suit                  | Give Samus the Flash Suit (aka Spike Suit)
| - Hyper Beam                  | Toggle Hyper Beam
| - Invincibility               | Prevents Samus from taking damage or knockback
| - Goo Slowdown                | Toggle ultra slow horizontal movement, as if grabbed by the Baby Metroid (2) or Draygon's goo (1-4)
| - Suit Properties             | Modify the suit properties similar to some randomizers
|                               | Vanilla = No change, Varia has full heat protection and 50% enemy/environmental damage reduction, Gravity (with or without Varia) has full heat protection and 75% enemy/environment damage reduction)
|                               | Balanced = Varia now has 75% environmental damage reduction, Gravity (without Varia) has no heat protection and no environment damage reduction
|                               | Progressive = Varia has no changes, Gravity (without Varia) has half heat protection and 50% enemy/environmental damage reduction
| - Magic Pants                 | Toggle a flashing animation on Samus to show when dash should be held for short charging
| - Space Pants                 | Toggle a flashing animation on Samus during a space jump to show when you should jump.
|                               | **Note**: If you have both Magic Pants and Space Pants on, only one of them will be used. 
|                               | If Space Jump is equipped then Space Pants will be used, otherwise Magic Pants will be used.
| - Loud Pants                  | Toggle sound effects for Magic Pants and Space Pants. Uses the sound selected in Game->Metronome SFX.
|                               | **Note**: If Magic and Space Pants are both turned off, this option has no effect.
| - Metronome                   | Toggles a metronome feature that will play a sound at a periodic rate
| - Metronome Tickrate          | The number of frames between metronome sounds
| - Metronome SFX               | The sound to play (Beep, Power Beam, Spazer, Missile, Click)
| - Kill Enemies                | Kills all non-solid enemies in the current room
| - Force Samus to Stand Up     | Forces Samus into a standing pose
|&nbsp;|
| **Infohud**                   | Configure the HUD
| - Infohud Mode                | Select the value from RAM to be displayed in the bottom-left of the HUD.
|                               | [Click the link for more details.](/infohudmode)
| - Room Strat                  | Select which Room Strat to be displayed in the bottom-left of the HUD.
|                               | This only works if "Room Strat" is selected as the above Infohud Mode.
| - Top-Left Display            | Choose item collection percentage, reserve energy, or vanilla health to be displayed at the top-left of the HUD.
|                               | The vanilla option also compresses the viewable area so it is more suitable for practice on an curved CRT monitor or TV.
| - Frame Counters              | Toggle the room timer in the top-right of the HUD between realtime and gametime.
| - Transition Lag              | Toggle the door time to include the full length of the room transition.
| - Reset Segment in Next Room  | Sets the segment timer to reset automatically when exiting the next door transition.
| - Freeze on Load State        | Experimental feature that causes the game to be frozen until a new controller 1 input is made.
|                               | It also resets the segment timer. Beware that since it leverages the existing frame advance feature, toggling this on changes the way frame advance works.
| - Status Icons                | Toggle icons to appear when standing on an elevator or when the shine timer is active (e.g. while carrying a spikesuit).
| - Artificial Lag              | Select a value to adjust how much lag occurs during normal gameplay. 
|                               | This is to compensate for the lack of a minimap on the HUD which would normally consume CPU cycles.
| - Customize RAM Watch         | Setup addresses to be monitored by the RAM Watch HUD mode. Address 1 will appear in the bottom-left corner of the HUD, while Address 2 appears just to the right of Address 1. Memory at these locations can be edited by configuring a Value and selecting 'Write to Address'. Toggle 'Lock Value' to automatically write the value once every frame. RAM Watch must must be the selected HUD mode to continue writing to the address. Only one byte of hex can be configured at a time in the menu. 'Hi' refers to the first byte, while 'Lo' refers to the second. Set the Hi Address to 0D and the Lo Address to EC to monitor the memory address $0DEC, which stores the counter for Samus direction changes while held by Draygon (among other uses). You can find lists of known RAM addresses by selecting 'Select Common Addresses'.
|&nbsp;|
| **Sprite Features**           | Features that draw sprites over normal gameplay. Beware of CPU performance impact
| - Samus on Top                | Draw Samus on top of foreground objects/tiles
| - Show Samus Hitbox           | Toggles an overlay of Samus hitbox that's drawn on top of Samus sprite.
| - Normal Enemy Hitboxes       | Toggles an overlay of enemy hitboxes that are drawn on top of enemy sprite. Some enemies, especially bosses, use the extended spritemap format. Use the Large Enemy Hitboxes option instead.
| - Large Enemy Hitboxes        | Toggles an overlay of enemy hitboxes for the following enemies that use the extended spritemap format: Mother Brain, Ridley, Draygon, Torizos, Spore Spawn, Crocomire, Ceres steam, Oums, and Space Pirates. Kraid would be in this list, but it is unsupported due to too many sprites being drawn.
| - Special Boss Hitboxes       | Toggles an overlay of Mother Brain's special hitboxes or Ridley's tail hitbox.
| - Samus Projectile Hitbox     | Toggles an overlay of Samus projectile hitboxes that are drawn on top of Samus projectile sprites.
| - Enemy Projectile Hitbox     | Toggles an overlay of enemy projectile hitboxes that are drawn on top of enemy projectile sprites.
| - OOB Tile Viewer             | This enables an overlay that shows the tiles near Samus at all times, disconnected from the camera. This allows you to navigate OOB (Out of Bounds) areas where neither Samus nor the actual tiles are visible in-game. Samus hitbox is drawn at the center of the overlay to show the position relative to the tiles.
| - Spacetime HUD               | Option to preserve the infohud when firing the spacetime beam
|&nbsp;|
| **Room Layout**               | Modify the room layout, usually to help practice rando scenarios
| - Remove Magnet Stairs        | Adds slope tiles to prevent the magnet stairs effect
| - Area Rando Patches          | Room modifications as you would see in a VARIA area randomizer
| - Anti-softlock Patches       | Room modifications as you would see in a typical VARIA randomizer
|&nbsp;|
| **Game**                      | Toggle game options
| - Japanese/French Text        | Standard game option to toggle between English and Japanese text (NTSC) or between German and French text (PAL).
| - Moon Walk                   | Standard game option for Moon Walk.
| - Icon Cancel                 | Standard game option for Icon Cancel.
| - Cutscenes                   | Turn off specific cutscenes, or make specific game sequences faster.
| - Fanfare                     | Toggle the fanfare for collecting items
| - Music                       | Toggle the music off, on, or fast off which eliminates lag caused by loading music data.
| - Low Health Alarm            | Modify the behavior of the low-health alarm
|                               | Never = Self-explanatory
|                               | Vanilla = No change (triggers on when <=30 health, off when >30 health, ignoring reserves, breaks if power bomb explosion is active)
|                               | PB Fix = Defers trigger during power bomb explosions, which fixes issue where the alarm may not turn on or turn off
|                               | Improved = PB Fix + only triggers on with health+reserves is less than 30 (same requirements as initiating health bomb)
| - Debug Mode                  | Toggles the debug mode. Note that debug mode shortcuts and features may not be well supported in the practice rom.
| - Debug CPU Brightness        | Toggles a built-in debug feature to darken the screen after the game is done processing the next frame. Useful for estimating CPU usage.
| - PAL Debug Movement          | PAL-only feature that gives Samus extra movement correlated to the dpad input.
| - Pacifist Mode               | Reduces Samus' attack damage to zero, allowing for never-ending boss battles.
| - Enable Projectiles          | Toggles a built-in debug feature to disable enemy projectiles.
| - Fix Scroll Offsets          | Fixes the glitchy state where the camera and scroll offsets are out of sync, typically occurring when using major glitches
| - Minimap                     | Restores the game minimap, which also allows the pause menu map to be updated. When enabled, a map tile counter will also be displayed.
| - Clear Minimap               | Clears the map tile counter and all minimap data.
|&nbsp;|
| **RNG Control**               | Pre-determine boss patterns
| - Rerandomize                 | Toggles rerandomizing of RNG values upon loading a savestate. SD2SNES/FXPak versions only.
| - Phantoon                    | Configure possible Phantoon patterns. You can enable or disable individual patterns per-round, allowing you to practice only a subset of possible patterns. The round-1 toggles apply only to the first round, whereas the round-2 toggles apply to all subsequent rounds, including rounds where Phantoon is invisible.
|                               | If all patterns are enabled (or disabled) for a round, vanilla RNG is used with all its quirks and biases. However, if you customize the patterns for a round, that round will use a customized RNG that chooses patterns with mostly-balanced probabilities (though slower patterns may still tend to be slightly more common).
|                               | - Phan Eye Close: Choose how long Phantoon's eye will remain open after a ring of flames
|                               | - Phan Flame Pattern: Choose one of four patterns for Phantoon's flames
|                               | - Next Flame Pattern: Swaps with Phan Flame Pattern each time Phantoon chooses a pattern
| - Botwoon RNG                 | Choose the opening pattern for Botwoon's first cycle
| - Draygon from Right          | Choose Draygon's attack type from the right side of the room. Draygon will always 'swoop' after a 'goop'.
| - Draygon from Left           | Choose Draygon's attack type from the left side of the room. Draygon will always 'swoop' after a 'goop'.
| - Crocomire RNG               | Set Crocomire to always step forward, or always swipe and shoot projectiles.
| - Kraid Claw RNG              | Set Kraid's claws to spawn above or below. Kraid is laggier when coming out of the ground if both claws spawn below. 
|                               | **Note**: It is not possible for both claws to spawn above Kraid, so there will always be some lag generated by a claw below.
|&nbsp;|
| **Controller Shortcuts**      | Set or change button combinations for activating features. Press A to edit the shortcut and then hold the desired button combination until it turns pink.
| - Main Menu                   | Open the InfoHUD menu
| - Save State                  | Sets the savestate. SD2SNES/FXPak versions only.
| - Load State                  | Loads the savestate. SD2SNES/FXPak versions only.
| - Reload Preset               | Reload the last selected category preset
| - Random Preset               | Randomly chooses a preset from your selected preset category
| - Save Cust Preset            | Save a custom preset to the current slot in SRAM.
| - Load Cust Preset            | Load the custom preset in the current slot in SRAM.
| - Next Preset Slot            | Increments the custom preset slot.
| - Prev Preset Slot            | Decrements the custom preset slot.
| - Reset Seg Timer             | Reset the segment timer. Takes effect immediately but only updates the display on certain events/actions.
| - Reset Seg Later             | Reset the segment timer. Takes effect when exiting the next door transition.
| - Full Equipment              | Refills your energy and ammo to their current max capacities.
| - Kill Enemies                | Instantly deletes all enemies in the current room.
| - Toggle OOB Tiles            | Toggles the OOB Tile Viewer.
| - Update Timers               | Updates the HUD timers immediately.
| - Clear Shortcuts             | Resets Main Menu shortcut to default and removes button combos for all others.


# Lag Frames

Super Metroid runs at ~60 fps (NTSC) or ~50 fps (PAL). On each frame, the game simultaneously renders the current frame while preparing the next frame. If it fails to prepare the next frame in time, then the previous frame is rendered again. We call this a lag frame.
This means that game lag depends on how much work the CPU needs to do to prepare the next frame. It follows that any modification to game code could impact the game lag. Thus we need to balance the desire for practice ROM features with the desire for performance accuracy (matching the actual game lag).
&nbsp;  
You might be wondering how we were able to add features at all, since generally adding features means adding work. In fact even if a feature is toggled off, the game may have to check that the feature is toggled off and that is more work.
Fortunately it was discovered that the minimap adds a noticeable amount of work to each frame, and by disabling the minimap we freed up CPU for our features. In fact, we even had to add artificial lag in order to more closely match actual game performance.
Unfortunately we weren't the only ones to notice this. Deer Force knew, and they also knew boss fights were laggy, so they disabled the minimap for most boss fights.
As a result, with default settings the practice ROM will have very similar lag compared to the actual game, except the practice ROM may have more lag during boss fights.
&nbsp;  
As we continue to maintain and add features to the practice ROM, this is our strategy for managing lag:

| <th width="600" />            |       |
| :---                          | :---  |
| - Normal Gameplay             | With default settings (enemy HP selected in the infohud), we really try not to change lag. If we do, it will be communicated.
|                               | If you select other infohud or room strat options, lag may have a slight variance although it typically won't be noticeable.
| - Events                      | On events (when drops appear, when an item is collected, etc.), we may add features. It's conceivable this could add a lag frame, although in most circumstances it would be unlikely or impossible.
| - Door/Elevator Transitions   | Similar to events, we may add features during this time. Some features require data to be reloaded during this time.
| - Practice Features           | Once you start turning on practice features, lag may no longer be similar to actual game. Some features like magic pants or the metronome may not have much impact, but others like the OOB tile viewer add a significant amount of work for the CPU.
| - Sprite Patches              | Sprite patches such as SpriteSomething should be supported. These patches sometimes modify the game and theoretically could affect lag on their own, although if you intend to play the vanilla game or randomizer with a sprite patch then you might as well apply it to the practice ROM.
<br />
